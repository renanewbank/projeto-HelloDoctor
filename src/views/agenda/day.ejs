<h1>Agenda do dia</h1>

<form method="get" action="/appointments/day" class="row">
  <input type="date" name="date" value="<%= date %>">
  <button>Ir</button>
</form>

<h3>Nova consulta</h3>
<form method="post" action="/appointments" class="card">
  <input type="date" name="date" value="<%= date %>" required>
  <input type="time" name="time" value="09:00" required>
  <select name="patient_id" required>
    <option value="">-- paciente --</option>
    <% patients.forEach(p => { %>
      <option value="<%= p.id %>"><%= p.full_name %></option>
    <% }) %>
  </select>
  <select name="appointment_type" required>
    <option value="PRIMEIRA_VEZ">Primeira vez</option>
    <option value="RETORNO">Retorno</option>
  </select>
  <select name="insurance_id">
    <option value="">-- convÃªnio (opcional) --</option>
    <% insurances.forEach(i => { %>
      <option value="<%= i.id %>"><%= i.name %></option>
    <% }) %>
  </select>
  <button>Agendar</button>
</form>

<h3>Consultas</h3>
<table>
  <thead><tr><th>Hora</th><th>Paciente</th><th>Tipo</th><th>Status</th><th>Remarcar</th></tr></thead>
  <tbody>
  <% items.forEach(it => { %>
    <tr>
      <td><%= it.hhmm %></td>
      <td><%= it.full_name %></td>
      <td><%= it.appointment_type %></td>
      <td><%= it.status %></td>
      <td>
        <form method="post" action="/appointments/<%= it.id %>/reschedule" class="row">
          <input type="date" name="date" value="<%= it.ymd %>">
          <input type="time" name="time" value="<%= it.hhmm %>">
          <button>Salvar</button>
        </form>
      </td>
    </tr>
  <% }) %>
  </tbody>
</table>
